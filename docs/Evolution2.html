<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Games Plants Play</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Game Theory</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Games plants play
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./GamesPlantsPlay.html">1. The basic plant game</a>
    </li>
    <li>
      <a href="./Evolution1.html">2. Evolutionary dynamics</a>
    </li>
    <li>
      <a href="./Evolution2.html">3. The modified plant game</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<!-- # Exercise: Games Plants Play {.tabset} -->
<div id="evolution-in-the-modified-model" class="section level2">
<h2>Evolution in the modified model</h2>
<p>Let us modify one assumption in our model. Above we assumed that the minimum and maximum amount of photosyntesis, <span class="math inline">\(P_L\)</span> and <span class="math inline">\(P_H\)</span>, are fixed parameters. Hanna Kokko suggests that the values of <span class="math inline">\(P_L\)</span> and <span class="math inline">\(P_H\)</span> are determined by leaf structure. Indeed, some plant species have rather thick, leathery leaves that are protected by a very thick cuticula while other plants have rather thin leaves that are hardly protected by a cuticula. This plant trait is generally related to the amount of sun light a plant is exposed to. Leave thickness is an adaptation against water loss and plants exposed to more intense sun light have thicker leaves, which decreases their photosytetic efficiency. It therefore seems reasonable to assume that plants that are shaded by other plants have thiner leaves that can photosythesize more efficiently and therefore have a higher value for <span class="math inline">\(P_L\)</span>. Let us implement this idea by making <span class="math inline">\(P_L\)</span> a function of the degree of shading from a competing plant. More specifically, we will assume that <span class="math inline">\(P_L\)</span> of a plant with strategy <span class="math inline">\(h&#39;\)</span> increases with increasing height difference <span class="math inline">\(h-h&#39;\)</span>. A function for <em>P_L(h’, h)</em> that depends on <em>h’-h</em> and has the desired porperties is the following one:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">P.L.flex &lt;-<span class="st"> </span><span class="cf">function</span>(h.m, h.r) {</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  P.L.mean <span class="op">+</span><span class="st"> </span>P.L.var<span class="op">*</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(gamma<span class="op">*</span>(h.m <span class="op">-</span><span class="st"> </span>h.r))) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># the parameter P.L.mean gives P.L when h&#39;=h</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">P.L.mean &lt;-<span class="st"> </span><span class="fl">0.25</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># next the parameter determining the maximum difference in P.L between</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># completely shaded and maximally sun exposed</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">P.L.var &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># finally the parameter determining how fast P.L increases with increased</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># shading from a competitor</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">gamma &lt;-<span class="st"> </span><span class="dv">10</span> </a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw">curve</span>(<span class="kw">P.L.flex</span>(x, <span class="dt">h.r =</span> <span class="fl">0.5</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;height &quot;</span><span class="op">*</span><span class="st"> </span>h[<span class="dv">1</span>]), <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;minimum photosynthesis, &quot;</span> <span class="op">*</span><span class="st"> </span>P[L](h[<span class="dv">1</span>], h[<span class="dv">2</span>] <span class="op">*</span><span class="st"> &quot;=0.5&quot;</span>)))</a></code></pre></div>
<p><img src="Evolution2_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Now we can plot how the fact that <span class="math inline">\(P.L\)</span> depends on the plant heights <span class="math inline">\(h&#39;\)</span> and <span class="math inline">\(h\)</span> affects the shape of the function <span class="math inline">\(g(h_1, h_2)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">g<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(h.m, h.r) { <span class="co"># this a new function for g(h&#39;, h) that incorporates our function for P.L</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="kw">P.L.flex</span>(h.m, h.r) <span class="op">+</span><span class="st"> </span>(P.H <span class="op">-</span><span class="st"> </span><span class="kw">P.L.flex</span>(h.m, h.r))<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>beta<span class="op">*</span>(h.m <span class="op">-</span><span class="st"> </span>h.r)))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">beta &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># how fast does g change</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">P.H &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># maximum photosythesis (identical in both versions of the model)</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">g &lt;-<span class="st"> </span><span class="cf">function</span>(h.m, h.r) { <span class="co"># the old function g(h&#39;, h) for comparison</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  P.L <span class="op">+</span><span class="st"> </span>(P.H <span class="op">-</span><span class="st"> </span>P.L)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>beta<span class="op">*</span>(h.m <span class="op">-</span><span class="st"> </span>h.r)))</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">P.L &lt;-<span class="st"> </span><span class="fl">0.25</span> <span class="co"># parameter determing the mimum photosynthesis in model with fixed P.L,</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># here chosen to be equal to P.L.mean &lt;- 0.25 for comparison</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="kw">curve</span>(<span class="kw">g.2</span>(x, <span class="dt">h.r =</span> <span class="fl">0.5</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;plant height, h&#39;&quot;</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;photosythesis/leaf, g(h&#39;, h = 0.5)&quot;</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="kw">curve</span>(<span class="kw">g</span>(x, <span class="dt">h.r =</span> <span class="fl">0.5</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="kw">expression</span>(P[L] <span class="op">*</span><span class="st"> &quot; fixed &quot;</span>),</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">                              <span class="kw">expression</span>(P[L] <span class="op">*</span><span class="st"> &quot; variable &quot;</span>)), <span class="dt">lty =</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>))</a></code></pre></div>
<p><img src="Evolution2_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>We are interested in how our new assumption affect the PIP and whether we find heights <em>h’</em> and <em>h</em> that are able to coexist with each other. To this end, we repeat the same steps as on the previous side. First, we produce the PIP.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(h) { <span class="co"># same function f(h) as before</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h<span class="op">^</span>alpha</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">alpha &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># same parameter value as before</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">w<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(h.m, h.r) { <span class="co"># payoff function now based on flexible P.L</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="kw">f</span>(h.m) <span class="op">*</span><span class="st"> </span><span class="kw">g.2</span>(h.m, h.r)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">s &lt;-<span class="st"> </span><span class="cf">function</span>(h.m, h.r) { <span class="co"># invasion fitness</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  <span class="kw">w.2</span>(h.m, h.r) <span class="op">-</span><span class="st"> </span><span class="kw">w.2</span>(h.r, h.r)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">PIP &lt;-<span class="st"> </span><span class="kw">outer</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), s)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="kw">par</span>(<span class="dt">pty=</span><span class="st">&quot;s&quot;</span>)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="kw">filled.contour</span>(<span class="kw">t</span>(PIP), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&quot;PIP&quot;</span>,</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">               <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;height h&quot;</span>),</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">               <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;height h&#39;&quot;</span>))</a></code></pre></div>
<p><img src="Evolution2_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Next, the mirror image of the PIP.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">s.flipped.roles &lt;-<span class="st"> </span><span class="cf">function</span>(h.m, h.r) {</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  <span class="kw">w.2</span>(h.r, h.m) <span class="op">-</span><span class="st"> </span><span class="kw">w.2</span>(h.m, h.m)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">PIP.mirrored &lt;-<span class="st"> </span><span class="kw">outer</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), s.flipped.roles)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">par</span>(<span class="dt">pty=</span><span class="st">&quot;s&quot;</span>)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">filled.contour</span>(<span class="kw">t</span>(PIP.mirrored), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&quot;PIP.mirrored&quot;</span>,</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">               <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;height h&quot;</span>),</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">               <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;height h&#39;&quot;</span>))</a></code></pre></div>
<p><img src="Evolution2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>And finally the PIP and it mirror image superimposed.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">pty=</span><span class="st">&quot;s&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">TEP &lt;-<span class="st"> </span><span class="kw">ifelse</span>(PIP <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>PIP.mirrored <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="kw">ifelse</span>(PIP <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>PIP.mirrored <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw">filled.contour</span>(<span class="kw">t</span>(TEP), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">-0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="dt">plot.title=</span>{</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;PIP and PIP.mirrored superimposed&quot;</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  <span class="kw">title</span>(<span class="dt">xlab=</span><span class="kw">expression</span>(<span class="st">&quot;height h&quot;</span>))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  <span class="kw">title</span>(<span class="dt">ylab=</span><span class="kw">expression</span>(<span class="st">&quot;height h&#39;&quot;</span>))</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">})</a></code></pre></div>
<p><img src="Evolution2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Something very interesting has happend! The green region in the last plot shows combinations of plant heights <em>h’</em> and <em>h</em> that each have a positive invasion fitness when rare. Thus, these different plants (plant species) are able to coexist with each other in a stable polymorphism. In fact, the PIP above is very special as it shows a so-called <em>evolutionary branching point</em> where one population can split into two in a process of gradual evolution. Models with such branching point play an important role in speciation research.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
