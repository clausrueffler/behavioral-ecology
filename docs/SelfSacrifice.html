<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>The Evolution of Altruism</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Game Theory</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Games Theory: Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./GamesPlantsPlay.html">1. The Basic Plant Height Game</a>
    </li>
    <li>
      <a href="./Evolution1.html">2. Evolution of Plant Height</a>
    </li>
    <li>
      <a href="./Evolution2.html">3. Evolution in the Modified Plant Game</a>
    </li>
    <li>
      <a href="./SelfSacrifice.html">4. The Evolution of Altruism</a>
    </li>
    <li>
      <a href="./PlantHeightAltruism.html">5. The Plant Height Model with Kin Selection</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<!-- # Games Plants Play {.tabset} -->
<div id="the-evolution-of-altruism" class="section level2">
<h2>The Evolution of Altruism</h2>
<p>On this page, we explore a model for the evolution of altruism.
Specifically, we investigate the possibility that individuals sacrifice
their own life in order to increase the survival of other individuals.
As we will see, such behavior can evolve if a self-sacrifice benefits
related individuals.</p>
<p>In this example, <em>payoff</em> is equal to <em>survival</em>.
Individuals are characterized by a strategy <em>x</em>, which is the
probability that they sacrifice their life in order to increase the
survival of another individual with which they interact. For examples, a
focal individual can give its resources to another individual. As a
result, the focal individual dies while the survival of the interacting
individual increases by <em>B</em>.</p>
<p>The survival of an individual that sacrifices itself is assumed to be
zero. If an individual does not sacrifice its life it survives with
probability <span class="math inline">\(S\)</span>. This survival
probability can be increased by an amount <span
class="math inline">\(B\)</span> if the interacting individual
sacrifices its life. With this, the expected survival of an individual
with strategy <span class="math inline">\(x&#39;\)</span> that interacts
with an individual with strategy <span class="math inline">\(x\)</span>
is</p>
<p><span class="math display">\[
\begin{align}
W(x&#39;, x) &amp; = (1 - x&#39;) (S + B x)
\end{align}
\]</span></p>
<!--
sacrificing its life, $W_C(x)$, and of an individual not sacrificing its life, $W_D(x)$, in a population where individuals in the resident population sacrifice their life with probability $x$ becomes

$$
\begin{align}
W_C(x) & = 0\\
W_D(x) & = S + B x.
\end{align}
$$

We here use the notation $W_C$ for individuals that self-sacrifice (*C* stands for cooperate) and $W_D$ for individuals that do not self-sacrifice (*D* stands for defect). *Cooperate* and *defect* is a common terminology in game theory in the context of altruism. Now let us consider a rare mutant that self-sacrifices with probability $x'$. With probability $x'$ this individuals dies and with probability $(1-x')$ it survives with probability $W_D(x)$. Taken together, the survival of a rare mutant individual with strategy $x'$ in a resident population with strategy $x$ is given by
-->
<p>Similarly, the expected survival of an individual with strategy <span
class="math inline">\(x\)</span> interacting with another individual
with strategy <span class="math inline">\(x\)</span> is given by</p>
<p><span class="math display">\[
\begin{align}
W(x, x) &amp; = (1 - x) (S + B x)
\end{align}
\]</span></p>
<p>The invasion fitness (or fitness advantage) of a rare mutant with
strategy <span class="math inline">\(x&#39;\)</span> in a resident
population with strategy <span class="math inline">\(x\)</span> can then
be written as</p>
<p><span class="math display">\[
\begin{align}
s(x&#39;, x) &amp; = W(x&#39;, x) - W(x, x)\\
        &amp; = (1 - x&#39;) (S + B x) - (1 - x) (S + B x)\\
        &amp; = (x - x&#39;) (S + B x).
\end{align}
\]</span></p>
<p>Since only mutants with <span class="math inline">\(s(x&#39;, x) &gt;
0\)</span> can invade, we can see from the above equation that a mutant
<span class="math inline">\(x&#39;\)</span> can invade a resident
population with strategy <span class="math inline">\(x\)</span> only if
<span class="math inline">\(x&#39; &lt; x\)</span>. From this, we can
conclude that <span class="math inline">\(x\)</span> will evolve to
<span class="math inline">\(x=0\)</span>: no individual sacrifices its
life to increase the survival of another individual. Also, <span
class="math inline">\(x^*=0\)</span> is an ESS, since any possible
mutant will then have a negative invasion fitness. This result makes
intuitive sense: We do not expect that natural selection favors to give
away ones life for the benefit of another individual.</p>
<p>We can confirm this result by plotting a <em>Pairwise Invadability
Plot</em>. Remember that a PIP is a contour plot of invasion fitness
<em>s(x’, x)</em>. PIP’s have a contour-line where <em>s(x’, x) =
0</em>. Since by definition <em>s(x, x) = 0</em>, PIP’s always have a
contour line along the diagonal (the 45-degree line). But as we have
seen in the plant-height model, mutants <em>x’</em> different from
<em>x</em> can also have zero-invasion fitness and these form a second
contour line in the PIP. Positive areas in the PIP correspond to
combinations of mutants with trait value <em>x’</em> and residents with
trait value <em>x</em> such that the mutant has positive invasion
fitness and can therefore establish itself in the population.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="cf">function</span>(x.m, x.r) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">-</span> x.m) <span class="sc">*</span> (S <span class="sc">+</span> B <span class="sc">*</span> x.r)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="cf">function</span>(x.m, x.r) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">w</span>(x.m, x.r) <span class="sc">-</span> <span class="fu">w</span>(x.r, x.r)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>PIP <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), s)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the computes s(x&#39;, x) for all combinations of x&#39; and x</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">filled.contour</span>(<span class="fu">t</span>(PIP), <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">main =</span> <span class="st">&quot;PIP&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">&quot;resident x&quot;</span>),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;mutant x&#39;&quot;</span>))</span></code></pre></div>
<p><img src="SelfSacrifice_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># yellow corresponds to combinations of mutants and residents</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># such that the mutant has a negative invasion fitness (it cannot invade)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># red corresponds to combinations of mutants and residents</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># such that the mutant has a positive invasion fitness (it can invade). </span></span></code></pre></div>
<p>As we can see, only mutants with <span class="math inline">\(x&#39;
&lt; x\)</span> can invade, confirming our above analytical result.</p>
<p>We can also arrive at this conclusion by looking at the partial
derivative of <span class="math inline">\(W(x&#39;, x)\)</span> with
respect to <span class="math inline">\(x&#39;\)</span> when evaluated at
<span class="math inline">\(x&#39; = x\)</span>, which equals</p>
<p><span class="math display">\[
\frac{\partial W(x&#39;, x)}{\partial x&#39;}\bigg|_{x&#39; = x} = -(S +
B x),
\]</span> which is always negative, indicating selection for lower
values of the helping trait <span class="math inline">\(x\)</span>.</p>
<div id="interaction-between-relatives" class="section level3">
<h3>Interaction between relatives</h3>
<p>In the above derivation, we assumed that individuals interact
randomly with each other. This means that a rare mutant with trait value
<span class="math inline">\(x&#39;\)</span> will almost always interact
with a resident individual with trait value <span
class="math inline">\(x\)</span>. Let us now assume that the mutation
occurs in a mother and that her offspring share the mutant allele with
her with probability <em>r</em>. Such siblings share the allele due to
<em>identity by decent</em>. If we assume a randomly mating population
in which the strategy is coded by a single diploid locus, then two full
siblings share the mutant allele <span
class="math inline">\(x&#39;\)</span> with probability <em>1/2</em> (one
of the siblings could have inherited the resident allele from the father
instead of from the mother). Crucially, we now assume that interactions
occur not with random individuals in the population but among siblings.
Under this assumption, an individual carrying the mutant allele <span
class="math inline">\(x&#39;\)</span> <em>does not self sacrifice</em>
with probability <span class="math inline">\(1 - x&#39;\)</span> and
then interacts with probability <span class="math inline">\(r\)</span>
with an individual carrying the same allele and with probability <span
class="math inline">\(1-r\)</span> with an individual carrying the
resident allele <span class="math inline">\(x\)</span>. Taken together,
the survival probability of a mutant individual with allele <span
class="math inline">\(x&#39;\)</span> that interacts with relatives in a
population where the resident allele is <span
class="math inline">\(x\)</span> is given by</p>
<p><span class="math display">\[
\begin{align}
w(x&#39;, x_{\mathrm r}, x) &amp; = (1 - x&#39;)(S + B x_{\mathrm r}).
\end{align}
\]</span></p>
<p>Here, the first argument <span class="math inline">\(x&#39;\)</span>
denotes the strategy of the focal individual, the second argument <span
class="math inline">\(x_{\mathrm r}\)</span> denotes the strategy of the
interacting individual, given by <span
class="math inline">\(x&#39;\)</span> (with probability <span
class="math inline">\(r\)</span>) or <span
class="math inline">\(x\)</span> (the third argument, with probability
<span class="math inline">\(1-r\)</span>). The allelic fitness for <span
class="math inline">\(x&#39;\)</span> and <span
class="math inline">\(x\)</span> can then be written as</p>
<p><span class="math display">\[
\begin{align}
W(x&#39;, x) &amp; = r w(x&#39;, x&#39;, x) + (1 - r) w(x&#39;, x, x) \\
        &amp; = (1 - x&#39;)(r (S + B x&#39;) + (1 - r) (S + B x) \\
        &amp; = (1 - x&#39;) ((S + B x) + r B (x&#39; - x)),\\\\
W(x, x) &amp; = r w(x, x, x) + (1 - r) w(x, x, x) \\
        &amp; = w(x, x, x)\\
        &amp; = (1 - x)(S + B x),
\end{align}
\]</span></p>
<p>respectively. With this, the fitness difference or invasion fitness
equals</p>
<p><span class="math display">\[
\begin{align}
s(x&#39;, x) &amp; = W(x&#39;, x) - W(x, x)\\
         &amp; = (1 - x&#39;) ((S + B x) + r B (x&#39; - x)) - (1 - x)(S
+ B x)\\
         &amp; = -(S + B x) (x&#39; - x) + r (1 - x&#39;) B\\
         &amp; = (x&#39; - x) (-(S + B x) + r (1 - x&#39;) B)
\end{align}
\]</span></p>
<p>Let us define <span class="math inline">\(c := (S + B x)\)</span> and
<span class="math inline">\(b := (1 - x&#39;) B\)</span>. Here, <span
class="math inline">\(c\)</span> is the survival probability of an
individual interacting with an individual with allele <span
class="math inline">\(x\)</span>. This is the potential survival that is
lost if an individual sacrifices itself, and therefore appears as a
direct cost. In contrast, <span class="math inline">\(b\)</span> is the
expected increase in survival when interacting with an individual with
allele <span class="math inline">\(x&#39;\)</span> and is thus an
indirect benefit.</p>
<p><span class="math display">\[
s(x&#39;, x)  = (x&#39; - x) (-c + r b),
\]</span></p>
<p>indicating that a mutant <span class="math inline">\(x&#39;\)</span>
that increases the probability of self-sacrifice (<span
class="math inline">\(x&#39; &gt; x\)</span>) can invade only if</p>
<p><span class="math display">\[
r b &gt; c.
\]</span></p>
<p>This last inequality is known as <strong>Hamilton’s Rule</strong>. It
says that an altruistic act can evolve only if the benefit <span
class="math inline">\(b\)</span> of an altruistic act, weighted by the
coefficient of relatedness <span class="math inline">\(r\)</span>
between the actor and receiver, is larger than the costs <span
class="math inline">\(c\)</span> to the actor.</p>
<p>We can also derive at this conclusion by looking at the partial
derivative of <span class="math inline">\(W(x&#39;, x)\)</span> with
respect to <span class="math inline">\(x&#39;\)</span> when evaluated at
<span class="math inline">\(x&#39; = x\)</span>, as we did in the
lecture. Then we obtain</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial W(x&#39;, x)}{\partial x&#39;}\bigg|_{x&#39; = x} &amp; =
r B -(S + Bx) + rBx - 2rBx
\\
&amp; = -\underbrace{(S + B x)}_{\text{costs} \,\, c} + r \underbrace{(1
- x)B}_{\text{benefits} \,\, b},
\end{align}
\]</span> indicating the selection favors mutants with increased
propensity to self-sacrifice if and only if <span
class="math inline">\(rb&gt;c\)</span>, that is, if Hamilton’s rule is
fulfilled.</p>
<p>What is the ESS for this model? To answer this question we again plot
the PIP.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="cf">function</span>(x.m, x.r) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">-</span> x.m) <span class="sc">*</span> (r <span class="sc">*</span> (S <span class="sc">+</span> B <span class="sc">*</span> x.m) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> r) <span class="sc">*</span> (S <span class="sc">+</span> B <span class="sc">*</span> x.r))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cf">function</span>(x.m, x.r) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">w</span>(x.m, x.r) <span class="sc">-</span> <span class="fu">w</span>(x.r, x.r)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>PIP <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), s)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># the computes s(x&#39;, x) for all combinations of x&#39; and x</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">filled.contour</span>(<span class="fu">t</span>(PIP), <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">main =</span> <span class="st">&quot;PIP&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">&quot;resident x&quot;</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;mutant x&#39;&quot;</span>))</span></code></pre></div>
<p><img src="SelfSacrifice_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>From this graph, we can read that <span class="math inline">\(x^* =
0.33\)</span> is an ESS. If the resident strategy is equal to this
value, then <span class="math inline">\(s(x&#39;, x^*) &lt; 0\)</span>
for all <span class="math inline">\(x&#39; \neq x^*\)</span>.</p>
<p>In order to determine whether a mutant <span
class="math inline">\(x&#39;\)</span> will replace the resident <span
class="math inline">\(x\)</span> or coexist with it, we plot the mirror
image of a PIP (mirrored over the 45-degree line).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>s.flipped.roles <span class="ot">&lt;-</span> <span class="cf">function</span>(x.m, x.r) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">w</span>(x.r, x.m) <span class="sc">-</span> <span class="fu">w</span>(x.m, x.m)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>PIP.mirrored <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), s.flipped.roles)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">filled.contour</span>(<span class="fu">t</span>(PIP.mirrored), <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">main =</span> <span class="st">&quot;PIP.mirrored&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">&quot;x&quot;</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;x&#39;&quot;</span>))</span></code></pre></div>
<p><img src="SelfSacrifice_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>In order to determine whether there are strategies (i.e.,
probabilities to self-sacrifice) that can coexist with each other we
superimpose the PIP with its mirror image.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>TEP <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(PIP <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> PIP.mirrored <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(PIP <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> PIP.mirrored <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filled.contour</span>(<span class="fu">t</span>(TEP), <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">plot.title=</span>{</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;PIP and PIP.mirrored superimposed&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="at">xlab=</span><span class="fu">expression</span>(<span class="st">&quot;x&quot;</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="at">ylab=</span><span class="fu">expression</span>(<span class="st">&quot;x&#39;&quot;</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="SelfSacrifice_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The green region in the last plot shows combinations of
self-sacrifice strategies <span class="math inline">\(x&#39;\)</span>
and <span class="math inline">\(x\)</span> that each have a positive
invasion fitness when rare. Thus, these different strategies are able to
coexist with each other in a stable polymorphism.</p>
<p>Importantly, there is no <em>evolutionary branching point</em>. Thus,
such a polymorphism cannot emerge by gradual evolution of the trait
value <span class="math inline">\(x\)</span>. It can only emerge through
a mutation with a relatively large mutational effect on <span
class="math inline">\(x\)</span>.</p>
<p>However, one can show that for areas of coexistence that are not
connected to an evolutionary branching point, further evolution of the
two coexisting strategies results in the convergence of the two strategy
values and ultimately in the loss of one of them. Evolution will then
result in the ESS <span class="math inline">\(x^*\)</span>.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
